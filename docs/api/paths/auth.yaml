/auth/register:
  post:
    tags:
      - Authentication
    summary: Register a new user
    description: |
      Create a new user account. After successful registration, an email verification 
      code will be sent to the provided email address.
    security: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [email, password, firstName, lastName]
            properties:
              email:
                type: string
                format: email
                example: "john.doe@example.com"
                description: "Valid email address"
              password:
                type: string
                minLength: 8
                example: "SecurePass123!"
                description: "Password must contain at least 8 characters with uppercase, lowercase, number, and special character"
              firstName:
                type: string
                maxLength: 50
                example: "John"
                description: "User's first name"
              lastName:
                type: string
                maxLength: 50
                example: "Doe"
                description: "User's last name"
    responses:
      '201':
        $ref: '../responses/common.yaml#/SuccessResponse'
      '400':
        $ref: '../responses/common.yaml#/BadRequest'
      '409':
        description: User already exists
        content:
          application/json:
            schema:
              $ref: '../schemas/common.yaml#/ErrorResponse'
      '429':
        $ref: '../responses/common.yaml#/TooManyRequests'

/auth/verify-email:
  post:
    tags:
      - Authentication
    summary: Verify user email
    description: "Verify a user's email address using the code sent during registration."
    security: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [email, code]
            properties:
              email:
                type: string
                format: email
                example: "john.doe@example.com"
              code:
                type: string
                example: "123456"
                description: "6-digit verification code sent to email"
    responses:
      '200':
        description: Email verified successfully
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/TokenResponse'
      '400':
        $ref: '../responses/common.yaml#/BadRequest'
      '429':
        $ref: '../responses/common.yaml#/TooManyRequests'

/auth/resend-verification:
  post:
    tags:
      - Authentication
    summary: Resend verification email
    description: "Resends the email verification code to a user's email address."
    security: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [email]
            properties:
              email:
                type: string
                format: email
                example: "john.doe@example.com"
    responses:
      '200':
        $ref: '../responses/common.yaml#/SuccessResponse'
      '400':
        $ref: '../responses/common.yaml#/BadRequest'
      '429':
        $ref: '../responses/common.yaml#/TooManyRequests'

/auth/login:
  post:
    tags:
      - Authentication
    summary: User login
    description: "Authenticates a user and returns JWT access and refresh tokens."
    security: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [email, password]
            properties:
              email:
                type: string
                format: email
                example: "john.doe@example.com"
              password:
                type: string
                example: "SecurePass123!"
    responses:
      '200':
        description: Login successful
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/TokenResponse'
      '401':
        $ref: '../responses/common.yaml#/Unauthorized'
      '429':
        $ref: '../responses/common.yaml#/TooManyRequests'

/auth/refresh-token:
  post:
    tags:
      - Authentication
    summary: Refresh access token
    description: "Issues a new access token using a valid refresh token."
    security: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [refreshToken]
            properties:
              refreshToken:
                type: string
                example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    responses:
      '200':
        description: Token refreshed successfully
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/TokenResponse'
      '401':
        $ref: '../responses/common.yaml#/Unauthorized'

/auth/logout:
  post:
    tags:
      - Authentication
    summary: User logout
    description: "Invalidates the user's refresh token, effectively logging them out."
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [refreshToken]
            properties:
              refreshToken:
                type: string
                example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    responses:
      '200':
        $ref: '../responses/common.yaml#/SuccessResponse'
      '400':
        $ref: '../responses/common.yaml#/BadRequest'
      '401':
        $ref: '../responses/common.yaml#/Unauthorized'

/auth/forgot-password:
  post:
    tags:
      - Authentication
    summary: Forgot password
    description: "Sends a password reset link to the user's email."
    security: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [email]
            properties:
              email:
                type: string
                format: email
                example: "john.doe@example.com"
    responses:
      '200':
        $ref: '../responses/common.yaml#/SuccessResponse'
      '400':
        $ref: '../responses/common.yaml#/BadRequest'
      '429':
        $ref: '../responses/common.yaml#/TooManyRequests'

/auth/reset-password:
  post:
    tags:
      - Authentication
    summary: Reset password
    description: "Resets the user's password using a valid reset token."
    security: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [token, newPassword]
            properties:
              token:
                type: string
                example: "abcd1234efgh5678ijkl9012mnop3456"
                description: "Password reset token received in email"
              newPassword:
                type: string
                minLength: 8
                example: "NewSecurePass123!"
                description: "New password meeting complexity requirements"
    responses:
      '200':
        $ref: '../responses/common.yaml#/SuccessResponse'
      '400':
        $ref: '../responses/common.yaml#/BadRequest'
      '401':
        $ref: '../responses/common.yaml#/Unauthorized'
      '429':
        $ref: '../responses/common.yaml#/TooManyRequests'

/auth/change-password:
  put:
    tags:
      - Authentication
    summary: Change password
    description: "Changes the authenticated user's password."
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [currentPassword, newPassword]
            properties:
              currentPassword:
                type: string
                example: "CurrentPass123!"
                description: "User's current password"
              newPassword:
                type: string
                minLength: 8
                example: "NewSecurePass123!"
                description: "New password meeting complexity requirements"
    responses:
      '200':
        $ref: '../responses/common.yaml#/SuccessResponse'
      '400':
        $ref: '../responses/common.yaml#/BadRequest'
      '401':
        $ref: '../responses/common.yaml#/Unauthorized'
      '429':
        $ref: '../responses/common.yaml#/TooManyRequests'

/auth/google:
  get:
    tags:
      - Authentication
    summary: Initiate Google OAuth
    description: "Redirects to Google OAuth for authentication."
    security: []
    parameters:
      - name: redirect
        in: query
        description: "URL to redirect after successful authentication"
        required: false
        schema:
          type: string
          format: uri
          example: "https://myapp.com/dashboard"
    responses:
      '302':
        description: Redirect to Google OAuth
      '400':
        $ref: '../responses/common.yaml#/BadRequest'
      '429':
        $ref: '../responses/common.yaml#/TooManyRequests'

/auth/google/callback:
  get:
    tags:
      - Authentication
    summary: Google OAuth callback
    description: "Handles the callback from Google OAuth."
    security: []
    parameters:
      - name: code
        in: query
        description: "Authorization code from Google"
        required: true
        schema:
          type: string
      - name: state
        in: query
        description: "State parameter for CSRF protection"
        required: false
        schema:
          type: string
    responses:
      '302':
        description: Redirect to success page with tokens
      '400':
        $ref: '../responses/common.yaml#/BadRequest'
      '401':
        $ref: '../responses/common.yaml#/Unauthorized' 